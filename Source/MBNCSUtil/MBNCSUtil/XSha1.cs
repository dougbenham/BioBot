using System;

namespace MBNCSUtil
{
	public static class XSha1
	{
		private static uint ROL(uint val, int shift)
		{
			shift &= 31;
			val = (val >> 32 - shift | val << shift);
			return val;
		}

		private unsafe static byte[] UnsafeHash(byte[] input)
		{
			if (input.Length > 1024)
			{
				throw new ArgumentOutOfRangeException(Resources.xshaMaxHash1024);
			}
			byte[] array = new byte[1024];
			Array.Copy(input, 0, array, 0, input.Length);
			uint* ptr2;
			uint num;
			uint num2;
			uint num3;
			uint num4;
			uint num5;
			fixed (byte* ptr = &array[0])
			{
				ptr2 = (uint*)ptr;
				for (int i = 0; i < 64; i++)
				{
					ptr2[i + 16] = XSha1.ROL(1u, (int)((ptr2[i] ^ ptr2[i + 8] ^ ptr2[i + 2] ^ ptr2[i + 13]) % 32u));
				}
				num = 1732584193u;
				num2 = 4023233417u;
				num3 = 2562383102u;
				num4 = 271733878u;
				num5 = 3285377520u;
				uint num6 = *(ptr2++) + XSha1.ROL(num, 5) + num5 + ((num2 & num3) | (~num2 & num4)) + 1518500249u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num, 5) + num5 + ((num2 & num3) | (~num2 & num4)) + 1518500249u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num, 5) + num5 + ((num2 & num3) | (~num2 & num4)) + 1518500249u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num, 5) + num5 + ((num2 & num3) | (~num2 & num4)) + 1518500249u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num, 5) + num5 + ((num2 & num3) | (~num2 & num4)) + 1518500249u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num, 5) + num5 + ((num2 & num3) | (~num2 & num4)) + 1518500249u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num, 5) + num5 + ((num2 & num3) | (~num2 & num4)) + 1518500249u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num, 5) + num5 + ((num2 & num3) | (~num2 & num4)) + 1518500249u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num, 5) + num5 + ((num2 & num3) | (~num2 & num4)) + 1518500249u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num, 5) + num5 + ((num2 & num3) | (~num2 & num4)) + 1518500249u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num, 5) + num5 + ((num2 & num3) | (~num2 & num4)) + 1518500249u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num, 5) + num5 + ((num2 & num3) | (~num2 & num4)) + 1518500249u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num, 5) + num5 + ((num2 & num3) | (~num2 & num4)) + 1518500249u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num, 5) + num5 + ((num2 & num3) | (~num2 & num4)) + 1518500249u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num, 5) + num5 + ((num2 & num3) | (~num2 & num4)) + 1518500249u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num, 5) + num5 + ((num2 & num3) | (~num2 & num4)) + 1518500249u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num, 5) + num5 + ((num2 & num3) | (~num2 & num4)) + 1518500249u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num, 5) + num5 + ((num2 & num3) | (~num2 & num4)) + 1518500249u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num, 5) + num5 + ((num2 & num3) | (~num2 & num4)) + 1518500249u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num, 5) + num5 + ((num2 & num3) | (~num2 & num4)) + 1518500249u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) + 1859775393u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) + 1859775393u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) + 1859775393u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) + 1859775393u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) + 1859775393u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) + 1859775393u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) + 1859775393u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) + 1859775393u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) + 1859775393u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) + 1859775393u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) + 1859775393u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) + 1859775393u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) + 1859775393u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) + 1859775393u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) + 1859775393u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) + 1859775393u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) + 1859775393u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) + 1859775393u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) + 1859775393u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) + 1859775393u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num6, 5) + num5 + ((num3 & num2) | (num4 & num3) | (num4 & num2)) - 1894007588u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num6, 5) + num5 + ((num3 & num2) | (num4 & num3) | (num4 & num2)) - 1894007588u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num6, 5) + num5 + ((num3 & num2) | (num4 & num3) | (num4 & num2)) - 1894007588u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num6, 5) + num5 + ((num3 & num2) | (num4 & num3) | (num4 & num2)) - 1894007588u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num6, 5) + num5 + ((num3 & num2) | (num4 & num3) | (num4 & num2)) - 1894007588u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num6, 5) + num5 + ((num3 & num2) | (num4 & num3) | (num4 & num2)) - 1894007588u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num6, 5) + num5 + ((num3 & num2) | (num4 & num3) | (num4 & num2)) - 1894007588u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num6, 5) + num5 + ((num3 & num2) | (num4 & num3) | (num4 & num2)) - 1894007588u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num6, 5) + num5 + ((num3 & num2) | (num4 & num3) | (num4 & num2)) - 1894007588u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num6, 5) + num5 + ((num3 & num2) | (num4 & num3) | (num4 & num2)) - 1894007588u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num6, 5) + num5 + ((num3 & num2) | (num4 & num3) | (num4 & num2)) - 1894007588u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num6, 5) + num5 + ((num3 & num2) | (num4 & num3) | (num4 & num2)) - 1894007588u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num6, 5) + num5 + ((num3 & num2) | (num4 & num3) | (num4 & num2)) - 1894007588u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num6, 5) + num5 + ((num3 & num2) | (num4 & num3) | (num4 & num2)) - 1894007588u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num6, 5) + num5 + ((num3 & num2) | (num4 & num3) | (num4 & num2)) - 1894007588u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num6, 5) + num5 + ((num3 & num2) | (num4 & num3) | (num4 & num2)) - 1894007588u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num6, 5) + num5 + ((num3 & num2) | (num4 & num3) | (num4 & num2)) - 1894007588u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num6, 5) + num5 + ((num3 & num2) | (num4 & num3) | (num4 & num2)) - 1894007588u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num6, 5) + num5 + ((num3 & num2) | (num4 & num3) | (num4 & num2)) - 1894007588u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = *(ptr2++) + XSha1.ROL(num6, 5) + num5 + ((num3 & num2) | (num4 & num3) | (num4 & num2)) - 1894007588u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) - 899497514u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) - 899497514u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) - 899497514u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) - 899497514u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) - 899497514u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) - 899497514u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) - 899497514u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) - 899497514u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) - 899497514u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) - 899497514u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) - 899497514u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) - 899497514u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) - 899497514u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) - 899497514u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) - 899497514u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) - 899497514u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) - 899497514u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) - 899497514u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) - 899497514u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
				num6 = (num4 ^ num3 ^ num2) + num5 + XSha1.ROL(num6, 5) + *(ptr2++) - 899497514u;
				num5 = num4;
				num4 = num3;
				num3 = XSha1.ROL(num2, 30);
				num2 = num;
				num = num6;
			}
			byte[] array2 = new byte[20];
			fixed (byte* ptr3 = &array2[0])
			{
				ptr2 = (uint*)ptr3;
				*(ptr2++) = 1732584193u + num;
				*(ptr2++) = 4023233417u + num2;
				*(ptr2++) = 2562383102u + num3;
				*(ptr2++) = 271733878u + num4;
				*ptr2 = 3285377520u + num5;
			}
			ptr2 = null;
			return array2;
		}

		public static byte[] CalculateHash(byte[] data)
		{
			return XSha1.UnsafeHash(data);
		}
	}
}
